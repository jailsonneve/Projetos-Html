<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Skinder - Loja</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">  
  <!-- Bootstrap Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <!-- Link do CSS -->
  <link rel="stylesheet" href="../../static/css/index.css">
  <!-- Link do SweetAlert2 -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <!-- JavaScript do Bootstrap -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
  <!-- Navbar -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark px-4 p-3">
    <h1 class="navbar-brand">Skinder</h1>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link" href="#">Avaliação de Rosto</a></li>
        <li class="nav-item"><a class="nav-link" href="#Itens">Mais Vendidos</a></li>
        <li class="nav-item"><a class="nav-link" href="#">Produtos</a></li>
        <li class="nav-item"><a class="nav-link" href="#sobreNos">Sobre Nós</a></li>
        <li class="nav-item"><a class="nav-link" href="#">Devoluções e Pedidos</a></li>
      </ul>
      <div class="search-container me-3">
        <select class="search-select">
            <option value="todos">Todos</option>
            <option value="limpeza">Limpeza</option>
            <option value="tonificacao">Tonificação</option>
            <option value="serum">Sérum</option>
            <option value="hidratacao">Hidratação</option>
            <option value="protetor_solar">Proteção Solar</option>
            <option value="esfoliacao">Esfoliação</option>
            <option value="mascara_facial">Máscaras Faciais</option>
            <option value="oleos">Óleos</option>
            <option value="cremes_noturnos">Cremes Noturnos</option>
        </select>
        <input type="text" class="search-input" placeholder="Pesquisar Skinder.com.br">
        <button class="search-button"><i class="bi bi-search"></i></button>
      </div>
      <div class="d-flex align-items-center">
        <a href="carrinho.html" class="carrinho"><span class="text-white me-3" id="cart-count" style="cursor: pointer;"><i class="bi bi-cart"></i> <span id="quantCart"> Carrinho</span> (0)</span></a>
        <button class="btn btn-outline-light me-2" data-bs-toggle="modal" data-bs-target="#modalLogin">Login</button>
      </div>
    </div>
  </nav>

  <!-- Modal Login/Cadastro -->
  <div class="modal fade" id="modalLogin" tabindex="-1" aria-labelledby="modalLoginLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content p-4">
        <div class="modal-header text-center">
          <h4 class="text-center mb-4">Entrar no Skinder</h4>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <input type="email" class="form-control" id="loginEmail" placeholder="Email" required>
          </div>
          <div class="mb-3">
            <div class="input-group">
              <input type="password" class="form-control" id="loginSenha" placeholder="Senha" required>
              <button class="btn btn-outline-secondary" type="button" id="toggleSenha">
                <i class="bi bi-eye"></i>
              </button>
            </div>
          </div>
          <button class="btn btn-primary w-100 mb-2" onclick="fazerLogin()">Entrar</button>
          <button class="btn btn-secondary w-100 mb-3" onclick="fazerCadastro()">Cadastrar</button>
          <hr>
          <button class="btn btn-danger w-100" onclick="entrarComGoogle()">Entrar com Google</button>
        </div>
      </div>
    </div>
  </div>  

  <!-- Main -->
  <main>
    <!-- Sobre Nós -->
    <section class="py-5 bg-light">
      <div class="container">
        <h2 class="text-center mb-4" id="sobreNos">Sobre Nós</h2>
        <p>
          Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed vehicula turpis vitae velit ullamcorper, eget sollicitudin leo consectetur. Phasellus gravida leo sit amet ante fermentum, in sollicitudin purus viverra. Integer ut ante vitae ipsum luctus facilisis eu et enim. Nam suscipit purus vel velit cursus, non vehicula purus tincidunt. Nulla at efficitur felis. Curabitur euismod augue non lorem auctor, in vulputate arcu fermentum. Cras euismod sapien ut orci consectetur, ac tincidunt nunc aliquet. Donec tempor lacus purus, id tristique purus ullamcorper sed. Fusce nec augue eget libero malesuada venenatis.
        </p>
        <p>
          Vivamus maximus neque purus, eu tristique ex ultricies a. Integer ac sollicitudin ligula, ac fringilla arcu. Phasellus convallis quam at venenatis hendrerit. Aliquam quis nisi eget purus fringilla fermentum nec non ipsum. Donec non est in libero rutrum scelerisque eget non elit. Nunc ac interdum velit. Etiam viverra sollicitudin risus, eget interdum arcu varius sed. Donec venenatis et odio nec porttitor. Ut sit amet mauris erat. Suspendisse a felis ex.
        </p>
      </div>
    </section>
    <section>
      <div class="container mt-4">
        <h1 class="text-center mb-4" id="Itens">Produtos mais Vendidos</h1>
        <div id="carouselItens" class="carousel slide carousel-fade" data-bs-ride="carousel">
          <div class="carousel-inner" id="itensContainer"></div>
        
          <!-- Botões de navegação com bolinha e ícone de seta -->
          <button class="carousel-control-prev" type="button" data-bs-target="#carouselItens" data-bs-slide="prev" style="border-radius: 50%; width: 40px; height: 40px; background-color: rgba(0,0,0,0.5); position: absolute; top: 50%; transform: translateY(-50%); left: 10px;">
            <span class="carousel-control-prev-icon" aria-hidden="true" style="width: 20px; height: 20px; background-image: none;">
              <i class="bi bi-chevron-left" style="color: white;"></i>
            </span>
            <span class="visually-hidden">Previous</span>
          </button>
          <button class="carousel-control-next" type="button" data-bs-target="#carouselItens" data-bs-slide="next" style="border-radius: 50%; width: 40px; height: 40px; background-color: rgba(0,0,0,0.5); position: absolute; top: 50%; transform: translateY(-50%); right: 10px;">
            <span class="carousel-control-next-icon" aria-hidden="true" style="width: 20px; height: 20px; background-image: none;">
              <i class="bi bi-chevron-right" style="color: white;"></i>
            </span>
            <span class="visually-hidden">Next</span>
          </button>
        </div>            
      </div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-dark text-white text-center py-3" id="footer">
    <div class="container-fluid">
      <p>&copy; 2025 Skinder. Todos os direitos reservados.</p>
      <div>
        <a href="https://www.facebook.com" target="_blank" class="text-white me-2"><i class="bi bi-facebook"></i></a>
        <a href="https://www.twitter.com" target="_blank" class="text-white me-2"><i class="bi bi-twitter"></i></a>
        <a href="https://www.instagram.com" target="_blank" class="text-white"><i class="bi bi-instagram"></i></a>
      </div>
      <p class="mt-2">Entre em contato: <a href="mailto:contato@example.com" class="text-white">contato@example.com</a> ou <span class="fone"> +55 (45)12345-6789 </span> </p>
    </div>
  </footer>
  <script>
    const itens = [
      {
        id: 1,
        nome: "Creme Calmante Multirreparador 17,5% Mix de Ativos Principia CM-01",
        descricao: "» Promover hidratação » Amenizar a irritação » Aliviar a ardência » Reduzir a descamação » Diminuir a vermelhidão » Melhorar assaduras»Aumentar a firmeza e elasticidade »Proporcionar maciez »Melhorar o viço.",
        preco: 4999.90,
        imagem: "../../static/imagens/Creme Calmante Multirreparador.webp",
        numVendas: 500,
        numAvaliacao: 0,
        valorEstrela: [1,4,3,2,5],
        comentarios: []
      },
      {
        id: 2,
        nome: "Espuma de limpeza Clean Beauty - Livia Diniz",
        descricao: "A Espuma de Limpeza Clean Beauty da Livia Diniz é o segredo para uma rotina de skincare eficaz e refrescante. Formulada com ingredientes de origem natural e livre de substâncias nocivas, esta espuma proporciona uma limpeza suave, porém profunda, removendo impurezas, oleosidade e resíduos de maquiagem, sem agredir a barreira natural da pele.",
        preco: 899.99,
        imagem: "../../static/imagens/Espuma de limpeza Clean Beauty - Livia Diniz LIVBEAUTY.webp",
        numVendas: 450,
        numAvaliacao: 0,
        valorEstrela: [5,3,2,4,1],
        comentarios: []
      },
      {
        id: 3,
        nome: "GEL DE LIMPEZA GL-02 350G",
        descricao: "Gel de limpeza com 11,5% de mix de tensoativos, 10% de glicerina e 1% de PCA sódio, com alta eficácia na melhora da oleosidade, poros dilatados e viço da pele. Indicado para peles sensíveis.",
        preco: 44,
        imagem: "../../static/imagens/GEL DE LIMPEZA GL-02 350G.webp",
        numVendas: 1700,
        numAvaliacao: 0,
        valorEstrela: [5,5,5,5,5],
        comentarios: []
      },
      {
        id: 4,
        nome: "Máscara Facial de Algodão, Kiss New York Professional, Pepino",
        descricao: "Calmante e antioxidanteInspirada no mundo inovador da beleza coreana, k-beauty.Proporciona uma pele ultra-hidratada, saudável e revitalizada.Dermatologicamente testada.Livre de parabenos e corantes artificias.",
        preco: 1299.90,
        imagem: "../../static/imagens/Máscara Facial de Algodão, Kiss New York Professional, Pepino.webp",
        numVendas: 890,
        numAvaliacao: 0,
        valorEstrela: [4,3,5,1,2],
        comentarios: []
      },
      {
        id: 5,
        nome: "Óleo de Limpeza Demaquilante OL-01",
        descricao: "Óleo de limpeza demaquilante com 30% de óleo de girassol, 15% mix de tensoativos e 1% vitamina E, com alta eficácia na remoção de maquiagem, inclusive resistente a água, resíduos de protetor solar e impurezas da pele.",
        preco: 699.99,
        imagem: "../../static/imagens/Óleo de Limpeza Demaquilante OL-01.webp",
        numVendas: 1350,
        numAvaliacao: 0,
        valorEstrela: [5,1,4,4,2],
        comentarios: []
      },
      {
        id: 6,
        nome: "Óleo De Rosa Mosqueta Mrfar 100% Puro 30ml Manchas E Estrias",
        descricao: "O Hidratante Corporal Óleo de Rosa Mosqueta é a escolha ideal para quem busca uma pele suave e bem cuidada. Com uma consistência cremosa, este produto é formulado para atender todos os tipos de pele, proporcionando hidratação intensa e duradoura por até 24 horas. Sua fórmula hipoalergênica garante segurança e conforto, mesmo para as peles mais sensíveis.",
        preco: 599.99,
        imagem: "../../static/imagens/Óleo de Rosa Mosqueta.webp",
        numVendas: 950,
        numAvaliacao: 0,
        valorEstrela: [3,2,1,5,1],
        comentarios: []
      }
    ];
    const carrinho = [];

    function gerarItens() {
      const container = document.getElementById("itensContainer");
      container.innerHTML = "";
    
      // Ordenar os itens por número de vendas (do maior para o menor)
      const itensOrdenados = [...itens].sort((a, b) => b.numVendas - a.numVendas);
    
      const grupoTamanho = 3; // 3 itens por slide
      const totalSlides = Math.ceil(itensOrdenados.length / grupoTamanho); // Quantidade total de slides
    
      for (let i = 0; i < totalSlides; i++) {
        const grupo = itensOrdenados.slice(i * grupoTamanho, (i + 1) * grupoTamanho);
    
        const slideAtivo = i === 0 ? "active" : ""; // Primeira slide será a ativa por padrão
    
        const slideHTML = `
          <div class="carousel-item ${slideAtivo}">
            <div class="row">
              ${grupo.map(item => `
                <div class="col-md-4 mb-4">
                  <div class="card h-100 text-center shadow-sm">
                    <img src="${item.imagem}" class="card-img-top" alt="${item.nome}">
                    <div class="card-body">
                      <h5 class="card-title">${item.nome}</h5>
                      <p class="card-text text-muted">${item.descricao}</p>
                      <p class="text-success fw-semibold fs-5">R$ ${item.preco.toFixed(2)} <span class="text-warning fw-semibold fs-5">${calcularEstrelas(item)}</span></p>
                      <div class="comentarios">
                        ${mostrarUltimosComentarios(item)}
                      </div>
                      <button class="btn btn-warning" onclick="avaliarItem(${item.id})"><i class="bi bi-star-fill"></i> Avaliar</button>
                      <button class="btn btn-primary ms-1" onclick="adicionarCarrinho(${item.id})"><i class="bi bi-cart-plus"></i> Adicionar ao Carrinho</button>
                    </div>
                  </div>
                </div>
              `).join('')}
            </div>
          </div>
        `;
    
        container.innerHTML += slideHTML;
      }
    }    

    const divCart = document.getElementById("quantCart");

    function avaliarItem(id) {
      const item = itens.find(i => i.id === id);

      Swal.fire({
        title: `Avaliar ${item.nome}`,
        html:
          `<div id="stars" style="font-size: 1.5rem; margin-bottom: 10px;">
            ${[1,2,3,4,5].map(i => `<i class="star" data-star="${i}">★</i>`).join('')}
          </div>
          <textarea id="comentario" class="swal2-textarea" placeholder="Comentário"></textarea>`,
        showCancelButton: true,
        confirmButtonText: "Enviar",
        didOpen: () => {
          const stars = document.querySelectorAll(".star");
          stars.forEach((star, index) => {
            star.addEventListener("click", () => {
              stars.forEach((s, i) => s.style.color = i <= index ? "#ffc107" : "gray");
              document.getElementById("stars").setAttribute("data-nota", index + 1);
            });
          });
        },
        preConfirm: () => {
          const nota = parseInt(document.getElementById("stars").getAttribute("data-nota") || 0);
          const comentario = document.getElementById("comentario").value.trim();

          if (!nota) {
            Swal.showValidationMessage("Por favor, selecione uma nota.");
          }

          return { nota, comentario };
        }
      }).then((result) => {
        if (result.isConfirmed) {
          item.comentarios.push(result.value.comentario);
          item.valorEstrela.push(result.value.nota);
          
          gerarItens();
          Swal.fire("Obrigado!", "Sua avaliação foi enviada.", "success");
        }
      });
    }

    function adicionarCarrinho(id) {
      const item = itens.find(i => i.id === id);
      carrinho.push(item);
      divCart.innerHTML = `(${carrinho.length})`
      Swal.fire("Adicionado!", `${item.nome} foi adicionado ao carrinho.`, "success");
    }

    function verCarrinho() {
      if (carrinho.length === 0) {
        Swal.fire("Carrinho vazio", "Nenhum item adicionado ainda.", "info");
        return;
      }

      let html = "<ul style='text-align:left;'>";
      let total = 0;

      carrinho.forEach(item => {
        html += `<li><strong>${item.nome}</strong> - R$ ${item.preco.toFixed(2)}</li>`;
        total += item.preco;
      });

      html += "</ul>";

      Swal.fire({
        title: "Itens no Carrinho",
        html: html + `<hr><strong>Total: R$ ${total.toFixed(2)}</strong>`,
        confirmButtonText: "Fechar"
      });
    }

    // Função de login
  function fazerLogin() {
    // Obtendo os valores dos campos
    const email = document.getElementById("loginEmail").value;
    const senha = document.getElementById("loginSenha").value;

    // Validação simples
    if (!email || !senha || !email.includes("@")) {
      Swal.fire({
        icon: 'error',
        title: 'Erro!',
        text: 'Por favor, preencha os campos corretamente!',
      });
      return;
    }

    // Aqui você pode adicionar sua lógica de autenticação
    // Exemplo de uma validação simples no cliente (idealmente, seria feito no servidor)
    if (email === "adm123@gmail.com" && senha === "adm123") {
      document.getElementById("loginEmail").value = ""; document.getElementById("loginSenha").value = "";
      Swal.fire({
        icon: 'success',
        title: 'Login realizado!',
        text: 'Bem-vindo ao Skinder!',
      }).then(() => {
        // Fechar o modal após o login
        var modal = bootstrap.Modal.getInstance(document.getElementById('modalLogin'));
        modal.hide();
      });
      window.location.href = "perfil.html"
    } else {
      Swal.fire({
        icon: 'error',
        title: 'Erro no login!',
        text: 'Email ou senha incorretos.',
      });
    }
  }

  // Função de cadastro (caso necessário)
  function fazerCadastro() {
    // Obtendo os valores dos campos
    const email = document.getElementById("loginEmail").value;
    const senha = document.getElementById("loginSenha").value;

    // Validação simples
    if (!email || !senha || !email.includes("@")) {
      Swal.fire({
        icon: 'error',
        title: 'Erro!',
        text: 'Por favor, preencha os campos corretamente!',
      });
      return;
    }else{
      Swal.fire({
        title: 'Cadastro',
        text: 'Função de cadastro ainda não implementada.',
        icon: 'info',
      });
    }
  }

  function entrarComGoogle() {
    Swal.fire({
        title: 'Entrar com o Google',
        text: 'Função de entrar com o Google ainda não implementada.',
        icon: 'info',
    });
  }

  // Função para mostrar/ocultar a senha
  document.getElementById("toggleSenha").addEventListener("click", function () {
      const senhaField = document.getElementById("loginSenha");
      const icon = this.querySelector("i");
      
      if (senhaField.type === "password") {
        senhaField.type = "text";
        icon.classList.remove("bi-eye");
        icon.classList.add("bi-eye-slash");
      } else {
        senhaField.type = "password";
        icon.classList.remove("bi-eye-slash");
        icon.classList.add("bi-eye");
      }
    });
    // Função para calcular as estrelas médias
  function calcularEstrelas(item) {
    // Verifica se existem avaliações
    if (item.valorEstrela.length === 0) {
      return "Nenhuma avaliação"; // Caso o item não tenha avaliações
    }

    // Calcula a média das estrelas
    const totalEstrelas = item.valorEstrela.reduce((acc, curr) => acc + curr, 0);
    const mediaEstrelas = totalEstrelas / item.valorEstrela.length;

    // Gera as estrelas de acordo com a média
    let estrelas = '';
    for (let i = 1; i <= 5; i++) {
      if (i <= Math.floor(mediaEstrelas)) {
        estrelas += '★'; // Estrela cheia
      } else if (i === Math.ceil(mediaEstrelas) && mediaEstrelas % 1 !== 0) {
        estrelas += '☆'; // Estrela vazia
      } else {
        estrelas += '☆'; // Estrela vazia
      }
    }

    return estrelas; // Retorna as estrelas como string
  }

  function mostrarUltimosComentarios(item) {
    // Limitar os comentários aos 5 mais recentes
    const ultimosComentarios = item.comentarios.slice(-5); 

    // Se não houver comentários, exibe uma mensagem padrão
    if (ultimosComentarios.length === 0) {
      return "Nenhum comentário ainda.";
    }

    // Exibir os comentários com estrelas associadas
    return ultimosComentarios.map((comentario, index) => {
        // Estrelas para cada comentário
        const estrelasComentario = item.valorEstrela[index];
        let estrelasHTML = '';
        for (let i = 1; i <= 5; i++) {
            if (i <= estrelasComentario) {
                estrelasHTML += '★'; // Estrela cheia
            } else {
                estrelasHTML += '☆'; // Estrela vazia
            }
        }

        return `<p class="text-black">User: ${comentario} (${estrelasHTML})</p>`;
    }).join('');
}
  gerarItens();
  </script>
</body>
</html>
